一、使用HDFS作为日志文件的存储系统，保证数据的可靠性与安全性
  
 +二、统计实现
 +
 +  1、统计每日、周、月的UV数量
 +
 +    （1）输入为一日或一周或一月的数据，输出为对应的UV数量
 +
 +    （2）map的输出以ip做key，value随意；reduce输出key为对应的一日或一周或一月，value为UV数量
 +
 +    （3）在reduce中设置全局计数器counter记录ip数量
 +
 +  2、统计每日的PV量
 +
 +    （1）输入为一日的数据，输出为该天的PV数量
 +
 +    （2）map中设置全局计数器，统计访问记录的数量，输出为该计数器的值，即当天的PV数量。
 +
 +  3、统计次日留存、次月留存
 +
 +    （1）次日留存
 +
 +        输入数据为第一天和第二天的数据，输出为留存率，即连续访问过两天的ip数量占第一天ip数量的比例
 +
 +        map输出的key为ip，value为以它所在文件的名字做标记
 +
 +        reduce中设置两个全局计数器，分别记录第一天的UV数量和两天都访问过的IP数量
 +
 +        在main函数中获取两个计数器的值，求比例
 +
 +    （2）次月留存（原理与次日留存相同）
 +
 +        输入数据为第一个月及第二个月的数据，输出为留存率，即连续访问过两月的ip数量占第一个月ip数量的比例
 +
 +        map的输出key为ip，value为以它所在文件的名字做标记
 +
 +        reduce中设置两个全局计数器，分别记录第一个月的UV数量和两个月都访问过的IP数量
 +
 +        在main函数中获取两个计数器的值，求比例
 +
 +  4、统计每类网页的跳转率
 +
 +    （1）首先根据数据确定有哪几类网页
 +
 +    （2）输入为需要统计跳转率的数据，输出为希望统计的某类网页的跳转率
 +
 +    （3）map输出key为该网页url，value为跳转网页url
 +
 +    （4）reduce中设置两个全局计数器，其中一个记录该网页的数量，另一个为跳转网页的数量
 +
 +    （5）main函数中获取计数器数值，进行比例求值
 +
 +  5、统计每天从baidu跳转过来的PV
 +
 +    （1）输入为一天的数据，输出为从百度跳转过来的PV
 +
 +    （2）map输出key为网页url，value为跳转url
 +
 +    （3）reduce设置计数器统计跳转url为baidu的数量
 +
 +    （4）main函数中输出计数器数值
 +
 + 
